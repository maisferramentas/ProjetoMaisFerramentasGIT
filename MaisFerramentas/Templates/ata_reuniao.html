<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Arrastar e reordenar elementos</title>
    <style>
      /* Estilo básico para os elementos */
      .draggable {
        width: 200px;
        margin: 10px;
        padding: 10px;
        background-color: #f0f0f0;
        border: 1px solid #ccc;
        cursor: pointer;
      }

      /* Estilo de pré-visualização */
      .placeholder {
        border: 2px dashed #aaa;
        margin: 0 0 10px 0;
      }
    </style>
  </head>
  <body>
    <!-- Elementos div com IDs numéricos -->
    <div id="1" class="draggable" draggable="true" ondragstart="drag(event)">
      Elemento 1<input type="text" />
    </div>
    <div id="2" class="draggable" draggable="true" ondragstart="drag(event)">
      Elemento 2<input type="text" />
    </div>
    <div id="3" class="draggable" draggable="true" ondragstart="drag(event)">
      Elemento 3<input type="text" />
    </div>

    <script>
      let dragged; // Variável global para armazenar o elemento sendo arrastado

      function drag(event) {
        dragged = event.target;
      }

      document.addEventListener("dragover", function (event) {
        event.preventDefault(); // Impede o comportamento padrão de "não deixar soltar" o elemento
      });

      document.addEventListener("drop", function (event) {
        event.preventDefault(); // Impede o comportamento padrão de "não deixar soltar" o elemento
        if (event.target.className === "draggable") {
          // Verifica se o alvo é uma div com a classe 'draggable'
          const bounding = event.target.getBoundingClientRect(); // Obtém o retângulo que representa o elemento
          const offset = bounding.y + bounding.height / 2; // Calcula o ponto médio vertical do elemento
          if (event.clientY - offset > 0) {
            // Verifica se o cursor está abaixo do ponto médio vertical
            event.target.parentElement.insertBefore(
              dragged,
              event.target.nextElementSibling
            ); // Insere o elemento arrastado após o elemento alvo
          } else {
            event.target.parentElement.insertBefore(dragged, event.target); // Insere o elemento arrastado antes do elemento alvo
          }
        }
        updateIds(); // Atualiza os IDs após o rearranjo
      });

      function updateIds() {
        const elements = document.querySelectorAll(".draggable"); // Seleciona todos os elementos com a classe 'draggable'
        elements.forEach((element, index) => {
          element.id = index + 1; // Atualiza o ID com base no índice do loop
        });
      }
    </script>
  </body>
</html>
